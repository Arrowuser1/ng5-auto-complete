{"version":3,"file":"auto.directive.js","sourceRoot":"","sources":["../auto.directive.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n    Directive,\n    ElementRef,\n    Input,\n    Renderer2,\n    OnInit,\n    EventEmitter,\n    Output,\n    Optional\n} from \"@angular/core\";\nimport { Observable } from \"rxjs\";\nimport { NgControl } from \"@angular/forms\";\n\ndeclare const $: any;\n\n@Directive({\n    selector: '[ng5-auto-complete]'\n})\n\nexport class AutoCompleteDirective implements OnInit {\n\n    @Output() ngModelChange = new EventEmitter(); // for normal model change\n    @Output() valueChanged = new EventEmitter();  // for normal value change\n    noRecordPlaceHolder: string;\n    filterName: string;\n    listlength: number = 15;\n    listType: string;\n    list: Array<any>;\n    wordTrigger: number;\n    listShown: any;\n    inpRef: any;\n    dropdownInitiated = false;\n\n    constructor(public elemRef: ElementRef,\n        public renderer: Renderer2,\n        @Optional() public reactiveFormControl: NgControl\n    ) {\n        this.inpRef = elemRef.nativeElement;\n        this.activateEvents();\n    }\n\n    ngOnInit() {\n        this.configureListType();\n        this.configureDirective();\n    }\n\n    @Input('ng5-auto-complete') set autoComplete(list: any) {\n        this.list = list ? (list.length ? list : []) : [];\n    }\n\n    @Input('word-trigger') set openOnWordLength(word_trigger: number) {\n        this.wordTrigger = Number(word_trigger);\n    }\n\n    @Input('list-length') set listLengthToShow(listlength: number) {\n        this.listlength = Number(listlength);\n    }\n\n    @Input('filterName') set filterIdentity(filterName: string) {\n        this.filterName = filterName;\n    }\n\n    @Input('no-record-text') set noRecordText(defaultText: string) {\n        this.noRecordPlaceHolder = defaultText;\n    }\n\n\n    configureListType() {\n\n        if (this.list.length && typeof this.list[0] === \"object\") {\n            this.listType = \"object\"\n        }\n\n        if (this.list.length && typeof this.list[0] === \"string\") {\n            this.listType = \"string\"\n        }\n    }\n\n    configureDirective() {\n        if (!this.inpRef[\"id\"]) {\n            throw \"auto-directive ID Required! Please provide the unique directive id\";\n        }\n\n        if (this.listType === \"object\" && !this.filterName) {\n            throw \"Object List Found! Please provide filterName to pluck from object\";\n        }\n\n        if (this.wordTrigger) {\n            this.listShown = [];\n            return;\n        }\n\n        // initiated coz- after one leter it helps to open\n        this.filterList();\n        this.initDropdown();\n    }\n\n    filterList() {\n        var that = this;\n        var fieldTomatch = new RegExp(that.elemRef.nativeElement[\"value\"], 'ig');\n        var data = [];\n\n        if (that.listType === \"string\") {\n            data = that.list.filter((item: any) => (item.toLowerCase()).match(fieldTomatch));\n        }\n\n        if (that.listType === \"object\") {\n            data = that.list.filter((item: any) => (item[that.filterName].toLowerCase()).match(fieldTomatch));\n        }\n\n        if (that.listlength) {\n            that.listShown = data.slice(0, this.listlength);\n        } else {\n            that.listShown = that.list; //all\n        }\n\n        return that.listShown;\n    }\n\n\n    initDropdown(list: any = undefined) {\n\n        var id = `#${this.inpRef[\"id\"]}`;\n\n        if (this.noRecordPlaceHolder &&\n            list === undefined &&\n            this.listShown.length === 1 &&\n            this.listShown[0] === this.noRecordPlaceHolder) {\n\n            var that = this;\n            var id = `#${that.inpRef[\"id\"]}`;\n\n            $(id).autocomplete({\n                source: function (request: any, response: any) {\n                    var matcher = new RegExp(that.noRecordPlaceHolder, \"i\");\n                    response(that.listShown, function (val: any) {\n                        console.log(val);\n                    });\n                }\n            })\n\n        } else {\n            if (this.listType === \"object\") {\n\n                var listData: any = [];\n                this.listShown.forEach((item: any) => {\n                    listData.push(item[this.filterName])\n                });\n\n                $(id).autocomplete({\n                    source: list != undefined ? list : listData\n                });\n\n            } else {\n                $(id).autocomplete({\n                    source: list != undefined ? list : this.listShown\n                });\n            }\n\n        }\n\n    }\n\n    searchfromList(ui: any) {\n        var that = this;\n\n        var toFind = (ui && ui.item) ? ui.item.value : that.elemRef.nativeElement[\"value\"];\n        if (that.listType === \"string\") {\n            var data = that.list.find(item => toFind === item);\n            return data;\n        }\n\n        if (that.listType === \"object\") {\n            var data = that.list.find(item => toFind === item[that.filterName]);\n            return data;\n        }\n    }\n\n    activateEvents() {\n        var that = this;\n        var id = `#${that.inpRef[\"id\"]}`;\n\n        $(id)\n            .on(\"autocompleteselect\", function (event: any, ui: any) {\n\n                //for ngmodule                \n                if (that.searchfromList(ui)) {\n                    that.ngModelChange.emit(ui.item.value);\n                    that.valueChanged.emit(ui.item.value);\n                } else {\n                    that.ngModelChange.emit(\"\");\n                    that.valueChanged.emit(\"\");\n                }\n\n                // for Rectiveforms model\n                if (that.reactiveFormControl) {\n                    if (that.searchfromList(ui)) {\n                        that.reactiveFormControl.control.setValue(ui.item.value);\n                    } else {\n                        that.reactiveFormControl.control.setValue(\"\");\n                    }\n                }\n\n            });\n\n        $(id)\n            .on(\"autocompletechange\", function (event: any, ui: any) {\n\n                //for ngmodule\n                if (that.searchfromList(ui)) {\n                    that.ngModelChange.emit(that.elemRef.nativeElement[\"value\"]);\n                    that.valueChanged.emit(that.elemRef.nativeElement[\"value\"]);\n\n                } else {\n                    that.ngModelChange.emit(\"\");\n                    that.valueChanged.emit(\"\");\n                }\n\n                // for Rectiveforms model\n                if (that.reactiveFormControl) {\n                    if (that.searchfromList(ui)) {\n                        that.reactiveFormControl.control.setValue(that.elemRef.nativeElement[\"value\"]);\n                    } else {\n                        that.reactiveFormControl.control.setValue(\"\");\n                    }\n                }\n\n            });\n\n        Observable.fromEvent(this.elemRef.nativeElement, 'keyup')\n            .subscribe((e: any) => {\n\n                this.removeOldList();\n\n                if (that.inpRef[\"value\"].length <= (that.wordTrigger - 1)) {\n                    that.initDropdown([]);\n                    return;\n                }\n\n                that.filterList();\n\n                if (that.noRecordPlaceHolder && !that.listShown.length) {\n                    this.listShown = [that.noRecordPlaceHolder];\n                    that.initDropdown();\n                    return;\n\n                }\n                that.initDropdown();\n            })\n    }\n\n    removeOldList() {\n        this.initDropdown([]);\n    }\n}"]}